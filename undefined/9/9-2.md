# \[9주차 우아한객체지향]

우선 우아한 객체지향에서 조영호님의 발표내용의 핵심은     
**의존성관리**인 것 같다     
이 의존성을 계속해서 관리해주지 않으면 결국에는 패키지사이클이 돌게 되고 양방향 연관관계로 이어지게 된다    
의존성을 관리하여 시스템을 진화시키는 것이 핵심이다    

자 이제 동영상을 보면서 내가 생각한 키워드와 설명에 대해 정리해보겠다    
다만 아직 이해가 정확하게 되지 않아 내용이 조금 많이 지저분 할 수도 있는 점은 양해 부탁드린다.     

우선 관계의 방향성에 대해 알아보도록 하자     
  
1. 연관관계 - 객체들의 협력을 위해 필요한 영구적인 탐색 구조    
2. 의존관계 - 객체들의 협력을 위해 일시적으로 필요한 의존성(파라미터, 리턴, 지연변수)   
   
연관관계는 탐색가능성이다    
객체 참조를 통해 연관관계를 구현할 수 있다    

Order라는 객체안에 orderLineItem을 컬렉션으로 포함하고 있으면 Order를 통해 orderLineItem에 접근이 가능하다    
이 때 Order라는 객체를 통해 orderLineItem을 찾을 수 있다    
또한 해당 객체안에 메소드를 만들기 전에 어떤 메시지를 줄 것인지 결정을 하고 메소드를 만들어주어야한다    
메소드를 만들고 메시지를 결정하는 것이 아님에 주의하자     

다음은 설계를 개선하는 방법에 대해 설명하겠다     
맨땅에 헤딩이라는 말을 들어보았을 것이다 설계를 하기도 전에 개선을 할 수는 없다    
우선 코드를 먼저 작성하고 의존성 관점에서 설계를 검토한다    


A,B라는 패키지의 양방향 관계가 생기면 A라는 패키지의 코드를 수정 시 B라는 패키지가 영향을 받는다    
의존성 사이클이 생기게 되는 것이다 이 경우에는 두 패키지 사이의 중간 객체를 만들어 의존성 사이클을 끊어주는 방법이 있다    
이 때 장점은 재사용성이 증가한다는 것이다   

요구사항이 추가될 수록 트랜잭션의 경합으로 성능이 저하되거나 응답성이 떨어지는 경우가 빈번하다    
그렇다면 객체 참조는 꼭 필요한 것인가?    
객체참조로 연관관계를 구현하게되면 객체가 모두 연결되어있어 어디든 탐색이 가능하다   
이는 객체그룹의 조회경계가 모호해지고, 트랜잭션의 범위도 모호해지게 된다    
객체참조는 결합도가 가장 높은 의존성이다    
필요한 경우에는 객체참조 관계를 끊어야한다    

Repository를 통해서 ID로 탐색이 가능하다 (약한 결합도)    

어떤 객체들을 묶고 어떤 객체들을 분리할 것인가(도메인 관점에 따라서)    
우선 객체들 중 함께 생성되고 삭제되는 것들끼리 하나의 트랜잭션으로 묶어준다(결합도가 높다) -> 객체 참조    
도메인 제약사항을 공유하는 객체들을 함께 묶는다    

비즈니스에 따라 도메인의 그룹을 잘 정리하고 Repository를 이용하여 ID로 연관관계를 구현한다(기존 객체참조에서 ID를 참조하도록 변경)     
나누어준 그룹단위로 트랜잭션단위를 묶고, 조회에 대한 경계도 그룹으로 묶는다     
참조가 없는 객체 그룹으로 나누고 나면 그룹단위의 영속성 저장소 변경이 가능하다    

이렇게 수정하게되면 기존 객체참조로 진행중이던 것들이 ID참조로 변경되어 컴파일 오류가 발생한다    
도메인 안의 로직은 객체참조로 되어있기 떄문이다    
여기서 발생한 오류를 해결하는 방법으로 객체를 직접 참조하는 로직을 다른 객체로 옮겨준다   

객체지향은 여러 객체를 오가며 로직을 파악한다(응집도가 낮음)    
때로는 절차지향이 객체지향보다 좋을 때도 있다    

의존성 역전    
- 인터페이스를 만들어 의존성을 역전시키는 방법이 있다    

또한 도메인 이벤트를 발행하기 위해서는     
SpringDataAggregate Abstraction이용하여 AbstractaggregateRoot를 상속받으면 registerEvent메소드를 제공해줌   
이때 원하는 이벤트를 만들어주면 커밋 시 이벤트를 발행해준다    
DB에 커밋이 되면 이벤트 핸들러에서 받아서 처리해줄 수 있음    
또는 어노테이션 이벤트리스너를 통해 이벤트를 발행받아 처리할 수 있다    

이벤트를 추가 후 의존성을 확인해보면 일시적으로 파라미터를 처리하는 과정에서 의존성 사이클이 발생하게 된다   
이벤트 핸들러가 패키지에 포함되어 발생하므로 패키지를 분리한다   
이후 의존성에 포함되는 로직을 분리해준다   
(도메인적으로 명확한 새로운 개념으로 패키지를 분리함)   

조영호님이 발표 내내 강조하신 부분은 의존성을 계속 확인하여 관리해주는 것이였다    

아직까지는 발표에 대한 내용이 막 엄청나게 와닿지는 않는 것 같다    
이건 계속 개발을 하다보면서 쌓이는 지식과 함께 계속해서 참고하다보면 이해하는 날이 오지 않을까 싶다    





